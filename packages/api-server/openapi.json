{
	"openapi": "3.1.0",
	"info": {
		"title": "Rita API",
		"version": "1.0.0",
		"description": "Rita API Server for the RITA Go application.\n\n## Authentication\nMost endpoints require authentication via Keycloak JWT token or session cookie.\n\n## Organization Context\nAll data is scoped to the user's active organization (tenant).\n\n## Real-time Updates\nFor real-time updates, connect to the SSE endpoint at `/api/sse/events`.\nSee AsyncAPI spec for event documentation.",
		"contact": {
			"name": "Rita Team"
		}
	},
	"servers": [
		{
			"url": "/",
			"description": "Current server"
		}
	],
	"tags": [
		{
			"name": "Auth",
			"description": "Authentication and session management"
		},
		{
			"name": "Clusters",
			"description": "Ticket cluster management"
		},
		{
			"name": "Conversations",
			"description": "Chat conversation management"
		},
		{
			"name": "Data Sources",
			"description": "Data source connections"
		},
		{
			"name": "Files",
			"description": "File upload and management"
		},
		{
			"name": "Members",
			"description": "Organization member management"
		},
		{
			"name": "Organizations",
			"description": "Organization settings"
		},
		{
			"name": "Invitations",
			"description": "User invitations"
		},
		{
			"name": "Credential Delegations",
			"description": "ITSM credential setup"
		},
		{
			"name": "Feature Flags",
			"description": "Feature flag access"
		},
		{
			"name": "SSE",
			"description": "Server-Sent Events"
		},
		{
			"name": "Workflows",
			"description": "Dynamic workflow generation"
		},
		{
			"name": "Health",
			"description": "Health check endpoints"
		}
	],
	"security": [
		{
			"bearerAuth": []
		},
		{
			"cookieAuth": []
		}
	],
	"components": {
		"securitySchemes": {
			"bearerAuth": {
				"type": "http",
				"scheme": "bearer",
				"bearerFormat": "JWT",
				"description": "Keycloak JWT token"
			},
			"cookieAuth": {
				"type": "apiKey",
				"in": "cookie",
				"name": "session",
				"description": "Session cookie authentication"
			}
		},
		"schemas": {
			"SignupResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"description": "Success message",
						"example": "Signup successful. Please check your email for verification instructions."
					}
				},
				"required": ["success", "message"]
			},
			"ErrorResponse": {
				"type": "object",
				"properties": {
					"error": {
						"type": "string",
						"description": "Error message",
						"example": "Resource not found"
					},
					"code": {
						"type": "string",
						"description": "Error code",
						"example": "NOT_FOUND"
					},
					"details": {
						"description": "Additional error details"
					}
				},
				"required": ["error"]
			},
			"SignupRequest": {
				"type": "object",
				"properties": {
					"firstName": {
						"type": "string",
						"minLength": 1,
						"description": "User first name",
						"example": "John"
					},
					"lastName": {
						"type": "string",
						"minLength": 1,
						"description": "User last name",
						"example": "Doe"
					},
					"email": {
						"type": "string",
						"format": "email",
						"description": "User email address",
						"example": "john@example.com"
					},
					"company": {
						"type": "string",
						"minLength": 1,
						"description": "Company name",
						"example": "Acme Inc"
					},
					"password": {
						"type": "string",
						"minLength": 1,
						"description": "User password"
					},
					"tosAcceptedAt": {
						"type": "string",
						"format": "date-time",
						"description": "Timestamp when TOS was accepted"
					}
				},
				"required": ["firstName", "lastName", "email", "company", "password"]
			},
			"ResendVerificationResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"description": "Generic response (does not reveal if email exists)",
						"example": "If a pending verification exists, a new email has been sent"
					}
				},
				"required": ["success", "message"]
			},
			"ResendVerificationRequest": {
				"type": "object",
				"properties": {
					"email": {
						"type": "string",
						"format": "email",
						"description": "Email address to resend verification to"
					}
				},
				"required": ["email"]
			},
			"LoginResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"user": {
						"$ref": "#/components/schemas/AuthUser"
					},
					"session": {
						"$ref": "#/components/schemas/AuthSession"
					}
				},
				"required": ["success", "user", "session"]
			},
			"AuthUser": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "User ID"
					},
					"email": {
						"type": "string",
						"format": "email",
						"description": "User email address"
					},
					"firstName": {
						"type": ["string", "null"],
						"description": "User first name"
					},
					"lastName": {
						"type": ["string", "null"],
						"description": "User last name"
					},
					"organizationId": {
						"type": ["string", "null"],
						"format": "uuid",
						"description": "Active organization ID"
					}
				},
				"required": ["id", "email", "firstName", "lastName", "organizationId"]
			},
			"AuthSession": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"description": "Session ID"
					},
					"expiresAt": {
						"type": "string",
						"format": "date-time",
						"description": "Session expiration timestamp"
					},
					"lastAccessedAt": {
						"type": "string",
						"format": "date-time",
						"description": "Last access timestamp"
					}
				},
				"required": ["id", "expiresAt"]
			},
			"LoginRequest": {
				"type": "object",
				"properties": {
					"accessToken": {
						"type": "string",
						"description": "Keycloak access token from client-side authentication"
					}
				},
				"required": ["accessToken"]
			},
			"LogoutResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"description": "Logout confirmation",
						"example": "Logged out successfully"
					}
				},
				"required": ["success", "message"]
			},
			"LogoutAllResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"deletedSessions": {
						"type": "number",
						"description": "Number of sessions that were destroyed",
						"example": 3
					}
				},
				"required": ["success", "deletedSessions"]
			},
			"VerifyEmailResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"description": "Verification confirmation",
						"example": "Email verified successfully. You can now sign in."
					},
					"email": {
						"type": "string",
						"format": "email",
						"description": "Verified email address"
					}
				},
				"required": ["success", "message", "email"]
			},
			"VerifyEmailRequest": {
				"type": "object",
				"properties": {
					"token": {
						"type": "string",
						"description": "Email verification token from the verification link"
					}
				},
				"required": ["token"]
			},
			"SessionResponse": {
				"type": "object",
				"properties": {
					"authenticated": {
						"type": "boolean",
						"enum": [true]
					},
					"user": {
						"$ref": "#/components/schemas/AuthUser"
					},
					"session": {
						"$ref": "#/components/schemas/AuthSession"
					}
				},
				"required": ["authenticated", "user", "session"]
			},
			"SessionUnauthenticatedResponse": {
				"type": "object",
				"properties": {
					"authenticated": {
						"type": "boolean",
						"enum": [false]
					},
					"error": {
						"type": "string",
						"description": "Error message"
					}
				},
				"required": ["authenticated", "error"]
			},
			"ProfileResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"user": {
						"$ref": "#/components/schemas/AuthUser"
					}
				},
				"required": ["success", "user"]
			},
			"UpdateProfileResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"user": {
						"$ref": "#/components/schemas/UpdatedUser"
					}
				},
				"required": ["success", "user"]
			},
			"UpdatedUser": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid"
					},
					"email": {
						"type": "string",
						"format": "email"
					},
					"firstName": {
						"type": ["string", "null"]
					},
					"lastName": {
						"type": ["string", "null"]
					}
				},
				"required": ["id", "email", "firstName", "lastName"]
			},
			"UpdateProfileRequest": {
				"type": "object",
				"properties": {
					"firstName": {
						"type": "string",
						"minLength": 1,
						"maxLength": 100,
						"description": "New first name"
					},
					"lastName": {
						"type": "string",
						"minLength": 1,
						"maxLength": 100,
						"description": "New last name"
					}
				}
			},
			"ClusterListResponse": {
				"type": "object",
				"properties": {
					"data": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/ClusterListItem"
						}
					},
					"pagination": {
						"$ref": "#/components/schemas/PaginationInfo"
					},
					"totals": {
						"$ref": "#/components/schemas/ClusterTotals"
					}
				},
				"required": ["data", "pagination", "totals"]
			},
			"ClusterListItem": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"example": "550e8400-e29b-41d4-a716-446655440000"
					},
					"name": {
						"type": "string",
						"example": "Password Reset Issues"
					},
					"subcluster_name": {
						"type": ["string", "null"],
						"example": "MFA Related"
					},
					"kb_status": {
						"$ref": "#/components/schemas/KBStatus"
					},
					"config": {
						"$ref": "#/components/schemas/ClusterConfig"
					},
					"ticket_count": {
						"type": "integer",
						"description": "Total tickets in cluster",
						"example": 42
					},
					"needs_response_count": {
						"type": "integer",
						"description": "Tickets needing response",
						"example": 15
					},
					"created_at": {
						"type": "string",
						"format": "date-time",
						"example": "2024-01-15T10:30:00.000Z"
					},
					"updated_at": {
						"type": "string",
						"format": "date-time",
						"example": "2024-01-15T10:30:00.000Z"
					}
				},
				"required": [
					"id",
					"name",
					"subcluster_name",
					"kb_status",
					"config",
					"ticket_count",
					"needs_response_count",
					"created_at",
					"updated_at"
				]
			},
			"KBStatus": {
				"type": "string",
				"enum": ["PENDING", "FOUND", "GAP"],
				"description": "Knowledge base status for cluster"
			},
			"ClusterConfig": {
				"type": "object",
				"properties": {
					"auto_respond": {
						"type": "boolean",
						"description": "Auto-respond enabled"
					},
					"auto_populate": {
						"type": "boolean",
						"description": "Auto-populate KB enabled"
					}
				}
			},
			"PaginationInfo": {
				"type": "object",
				"properties": {
					"next_cursor": {
						"type": ["string", "null"],
						"description": "Cursor for next page, null if no more pages",
						"example": "2024-01-15T10:30:00.000Z"
					},
					"has_more": {
						"type": "boolean",
						"description": "Whether there are more results",
						"example": true
					}
				},
				"required": ["next_cursor", "has_more"]
			},
			"ClusterTotals": {
				"type": "object",
				"properties": {
					"total_clusters": {
						"type": "integer",
						"description": "Total clusters matching filters",
						"example": 27
					},
					"total_tickets": {
						"type": "integer",
						"description": "Total tickets across matching clusters",
						"example": 238
					}
				},
				"required": ["total_clusters", "total_tickets"]
			},
			"ValidationError": {
				"type": "object",
				"properties": {
					"error": {
						"type": "string",
						"enum": ["Validation error"]
					},
					"details": {
						"type": "array",
						"items": {
							"type": "object",
							"properties": {
								"code": {
									"type": "string"
								},
								"path": {
									"type": "array",
									"items": {
										"anyOf": [
											{
												"type": "string"
											},
											{
												"type": "number"
											}
										]
									}
								},
								"message": {
									"type": "string"
								}
							},
							"required": ["code", "path", "message"]
						}
					}
				},
				"required": ["error", "details"]
			},
			"ClusterDetailsResponse": {
				"type": "object",
				"properties": {
					"data": {
						"$ref": "#/components/schemas/ClusterDetails"
					}
				},
				"required": ["data"]
			},
			"ClusterDetails": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid"
					},
					"organization_id": {
						"type": "string",
						"format": "uuid"
					},
					"model_id": {
						"type": "string"
					},
					"name": {
						"type": "string"
					},
					"subcluster_name": {
						"type": ["string", "null"]
					},
					"config": {
						"$ref": "#/components/schemas/ClusterConfig"
					},
					"kb_status": {
						"$ref": "#/components/schemas/KBStatus"
					},
					"kb_articles_count": {
						"type": "integer",
						"description": "Linked KB articles"
					},
					"ticket_count": {
						"type": "integer"
					},
					"open_count": {
						"type": "integer",
						"description": "Tickets needing response"
					},
					"created_at": {
						"type": "string",
						"format": "date-time"
					},
					"updated_at": {
						"type": "string",
						"format": "date-time"
					}
				},
				"required": [
					"id",
					"organization_id",
					"model_id",
					"name",
					"subcluster_name",
					"config",
					"kb_status",
					"kb_articles_count",
					"ticket_count",
					"open_count",
					"created_at",
					"updated_at"
				]
			},
			"ClusterTicketsResponse": {
				"type": "object",
				"properties": {
					"data": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/Ticket"
						}
					},
					"pagination": {
						"$ref": "#/components/schemas/PaginationInfo"
					}
				},
				"required": ["data", "pagination"]
			},
			"Ticket": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid"
					},
					"organization_id": {
						"type": "string",
						"format": "uuid"
					},
					"cluster_id": {
						"type": ["string", "null"],
						"format": "uuid"
					},
					"data_source_connection_id": {
						"type": ["string", "null"],
						"format": "uuid"
					},
					"external_id": {
						"type": "string",
						"description": "External ticket ID",
						"example": "INC0012345"
					},
					"subject": {
						"type": "string",
						"example": "Cannot reset password"
					},
					"external_status": {
						"type": "string",
						"description": "Status in source system",
						"example": "Open"
					},
					"cluster_text": {
						"type": ["string", "null"],
						"description": "Text used for clustering"
					},
					"rita_status": {
						"$ref": "#/components/schemas/RitaStatus"
					},
					"source_metadata": {
						"type": "object",
						"additionalProperties": {},
						"description": "Source-specific metadata"
					},
					"created_at": {
						"type": "string",
						"format": "date-time"
					},
					"updated_at": {
						"type": "string",
						"format": "date-time"
					}
				},
				"required": [
					"id",
					"organization_id",
					"cluster_id",
					"data_source_connection_id",
					"external_id",
					"subject",
					"external_status",
					"cluster_text",
					"rita_status",
					"source_metadata",
					"created_at",
					"updated_at"
				]
			},
			"RitaStatus": {
				"type": "string",
				"enum": ["NEEDS_RESPONSE", "COMPLETED"],
				"description": "Rita processing status for tickets"
			},
			"ClusterKbArticlesResponse": {
				"type": "object",
				"properties": {
					"data": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/KbArticle"
						}
					}
				},
				"required": ["data"]
			},
			"KbArticle": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid"
					},
					"filename": {
						"type": "string",
						"example": "password-reset-guide.pdf"
					},
					"file_size": {
						"type": "integer",
						"description": "Size in bytes",
						"example": 102400
					},
					"mime_type": {
						"type": "string",
						"example": "application/pdf"
					},
					"status": {
						"type": "string",
						"description": "Processing status",
						"example": "processed"
					},
					"created_at": {
						"type": "string",
						"format": "date-time"
					},
					"updated_at": {
						"type": "string",
						"format": "date-time"
					}
				},
				"required": [
					"id",
					"filename",
					"file_size",
					"mime_type",
					"status",
					"created_at",
					"updated_at"
				]
			},
			"ConversationResponse": {
				"type": "object",
				"properties": {
					"conversation": {
						"$ref": "#/components/schemas/Conversation"
					}
				},
				"required": ["conversation"]
			},
			"Conversation": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"example": "550e8400-e29b-41d4-a716-446655440000"
					},
					"title": {
						"type": "string",
						"example": "Password Reset Help"
					},
					"created_at": {
						"type": "string",
						"format": "date-time",
						"example": "2024-01-15T10:30:00.000Z"
					},
					"updated_at": {
						"type": "string",
						"format": "date-time",
						"example": "2024-01-15T10:30:00.000Z"
					}
				},
				"required": ["id", "title", "created_at", "updated_at"]
			},
			"CreateConversationRequest": {
				"type": "object",
				"properties": {
					"title": {
						"type": "string",
						"minLength": 1,
						"maxLength": 255,
						"description": "Conversation title",
						"example": "Password Reset Help"
					}
				},
				"required": ["title"]
			},
			"ConversationsListResponse": {
				"type": "object",
				"properties": {
					"conversations": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/Conversation"
						}
					},
					"total": {
						"type": "integer",
						"description": "Total conversations",
						"example": 42
					},
					"limit": {
						"type": "integer",
						"example": 20
					},
					"offset": {
						"type": "integer",
						"example": 0
					}
				},
				"required": ["conversations", "total", "limit", "offset"]
			},
			"MessagesResponse": {
				"type": "object",
				"properties": {
					"messages": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/Message"
						}
					},
					"hasMore": {
						"type": "boolean",
						"description": "Whether more messages exist"
					},
					"nextCursor": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "Cursor for next page"
					}
				},
				"required": ["messages", "hasMore", "nextCursor"]
			},
			"Message": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"example": "550e8400-e29b-41d4-a716-446655440001"
					},
					"message": {
						"type": "string",
						"example": "How do I reset my password?"
					},
					"role": {
						"$ref": "#/components/schemas/MessageRole"
					},
					"response_content": {
						"type": ["string", "null"],
						"description": "Assistant response content"
					},
					"status": {
						"$ref": "#/components/schemas/MessageStatus"
					},
					"created_at": {
						"type": "string",
						"format": "date-time",
						"example": "2024-01-15T10:30:00.000Z"
					},
					"processed_at": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "When message was processed"
					},
					"error_message": {
						"type": ["string", "null"],
						"description": "Error message if failed"
					},
					"metadata": {
						"type": ["object", "null"],
						"additionalProperties": {},
						"description": "Additional metadata"
					},
					"response_group_id": {
						"type": ["string", "null"],
						"format": "uuid",
						"description": "Group ID for related responses"
					},
					"user_email": {
						"type": ["string", "null"],
						"format": "email",
						"description": "Email of message sender"
					}
				},
				"required": [
					"id",
					"message",
					"role",
					"response_content",
					"status",
					"created_at",
					"processed_at",
					"error_message",
					"metadata",
					"response_group_id",
					"user_email"
				]
			},
			"MessageRole": {
				"type": "string",
				"enum": ["user", "assistant"],
				"description": "Message sender role"
			},
			"MessageStatus": {
				"type": "string",
				"enum": ["pending", "sent", "failed"],
				"description": "Message delivery status"
			},
			"MessageCreatedResponse": {
				"type": "object",
				"properties": {
					"message": {
						"$ref": "#/components/schemas/Message"
					},
					"webhook": {
						"type": "object",
						"properties": {
							"success": {
								"type": "boolean"
							},
							"error": {
								"type": ["string", "null"]
							}
						},
						"required": ["success", "error"],
						"description": "Webhook delivery result"
					}
				},
				"required": ["message", "webhook"]
			},
			"CreateMessageRequest": {
				"type": "object",
				"properties": {
					"content": {
						"type": "string",
						"minLength": 1,
						"description": "Message content",
						"example": "How do I reset my password?"
					}
				},
				"required": ["content"]
			},
			"UpdateConversationRequest": {
				"type": "object",
				"properties": {
					"title": {
						"type": "string",
						"minLength": 1,
						"maxLength": 255,
						"description": "New conversation title",
						"example": "Updated Title"
					}
				},
				"required": ["title"]
			},
			"DeleteConversationResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean"
					}
				},
				"required": ["success"]
			},
			"CreateDelegationResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"delegation_id": {
						"type": "string",
						"format": "uuid"
					},
					"message": {
						"type": "string",
						"example": "Credential delegation email sent"
					},
					"expires_at": {
						"type": "string",
						"format": "date-time"
					}
				},
				"required": ["success", "delegation_id", "message", "expires_at"]
			},
			"CreateDelegationRequest": {
				"type": "object",
				"properties": {
					"admin_email": {
						"type": "string",
						"format": "email",
						"description": "IT admin email to send delegation to"
					},
					"itsm_system_type": {
						"type": "string",
						"enum": ["servicenow_itsm", "jira"],
						"description": "ITSM system type"
					}
				},
				"required": ["admin_email", "itsm_system_type"]
			},
			"VerifyDelegationResponse": {
				"type": "object",
				"properties": {
					"valid": {
						"type": "boolean"
					},
					"organization_name": {
						"type": "string"
					},
					"itsm_system_type": {
						"type": "string",
						"enum": ["servicenow_itsm", "jira"],
						"description": "ITSM system type"
					},
					"expires_at": {
						"type": "string",
						"format": "date-time"
					},
					"reason": {
						"type": "string",
						"description": "Reason if invalid"
					}
				},
				"required": ["valid"]
			},
			"SubmitCredentialsResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"delegation_id": {
						"type": "string",
						"format": "uuid"
					},
					"message": {
						"type": "string",
						"example": "Credentials submitted successfully"
					}
				},
				"required": ["success", "delegation_id", "message"]
			},
			"SubmitCredentialsRequest": {
				"type": "object",
				"properties": {
					"token": {
						"type": "string",
						"minLength": 64,
						"maxLength": 64,
						"description": "Delegation token"
					},
					"credentials": {
						"type": "object",
						"additionalProperties": {},
						"description": "ITSM credentials (varies by system type)",
						"example": {
							"instance_url": "https://company.service-now.com",
							"username": "admin",
							"password": "***"
						}
					}
				},
				"required": ["token", "credentials"]
			},
			"DelegationStatusResponse": {
				"type": "object",
				"properties": {
					"status": {
						"type": "string",
						"enum": ["pending", "completed", "expired", "cancelled"],
						"description": "Delegation status"
					},
					"itsm_system_type": {
						"type": "string",
						"enum": ["servicenow_itsm", "jira"],
						"description": "ITSM system type"
					},
					"created_at": {
						"type": "string",
						"format": "date-time"
					},
					"expires_at": {
						"type": "string",
						"format": "date-time"
					},
					"completed_at": {
						"type": ["string", "null"],
						"format": "date-time"
					}
				},
				"required": [
					"status",
					"itsm_system_type",
					"created_at",
					"expires_at",
					"completed_at"
				]
			},
			"DelegationListResponse": {
				"type": "object",
				"properties": {
					"delegations": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/CredentialDelegation"
						}
					}
				},
				"required": ["delegations"]
			},
			"CredentialDelegation": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "Delegation ID"
					},
					"adminEmail": {
						"type": "string",
						"format": "email",
						"description": "IT admin email"
					},
					"itsmSystemType": {
						"type": "string",
						"enum": ["servicenow_itsm", "jira"],
						"description": "ITSM system type"
					},
					"status": {
						"type": "string",
						"enum": ["pending", "completed", "expired", "cancelled"],
						"description": "Delegation status"
					},
					"createdAt": {
						"type": "string",
						"format": "date-time",
						"description": "Created timestamp"
					},
					"expiresAt": {
						"type": "string",
						"format": "date-time",
						"description": "Expiration timestamp"
					},
					"completedAt": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "Completion timestamp"
					}
				},
				"required": [
					"id",
					"adminEmail",
					"itsmSystemType",
					"status",
					"createdAt",
					"expiresAt",
					"completedAt"
				]
			},
			"CancelDelegationResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"example": "Delegation cancelled"
					}
				},
				"required": ["success", "message"]
			},
			"DataSourceListResponse": {
				"type": "object",
				"properties": {
					"data": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/DataSourceConnection"
						}
					}
				},
				"required": ["data"]
			},
			"DataSourceConnection": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid"
					},
					"organization_id": {
						"type": "string",
						"format": "uuid"
					},
					"type": {
						"$ref": "#/components/schemas/DataSourceType"
					},
					"name": {
						"type": "string"
					},
					"description": {
						"type": ["string", "null"]
					},
					"settings": {
						"type": "object",
						"additionalProperties": {}
					},
					"status": {
						"$ref": "#/components/schemas/DataSourceStatus"
					},
					"last_sync_status": {
						"$ref": "#/components/schemas/SyncStatus"
					},
					"last_sync_at": {
						"type": ["string", "null"],
						"format": "date-time"
					},
					"last_sync_error": {
						"type": ["string", "null"]
					},
					"last_verification_at": {
						"type": ["string", "null"],
						"format": "date-time"
					},
					"last_verification_error": {
						"type": ["string", "null"]
					},
					"latest_options": {
						"type": ["object", "null"],
						"additionalProperties": {},
						"description": "Options returned from verification (e.g., available spaces)"
					},
					"enabled": {
						"type": "boolean"
					},
					"created_by": {
						"type": "string",
						"format": "uuid"
					},
					"updated_by": {
						"type": "string",
						"format": "uuid"
					},
					"created_at": {
						"type": "string",
						"format": "date-time"
					},
					"updated_at": {
						"type": "string",
						"format": "date-time"
					}
				},
				"required": [
					"id",
					"organization_id",
					"type",
					"name",
					"description",
					"settings",
					"status",
					"last_sync_status",
					"last_sync_at",
					"last_sync_error",
					"last_verification_at",
					"last_verification_error",
					"latest_options",
					"enabled",
					"created_by",
					"updated_by",
					"created_at",
					"updated_at"
				]
			},
			"DataSourceType": {
				"type": "string",
				"enum": [
					"confluence",
					"servicenow",
					"servicenow_itsm",
					"sharepoint",
					"websearch",
					"jira_itsm",
					"freshdesk"
				],
				"description": "Type of data source connection"
			},
			"DataSourceStatus": {
				"type": "string",
				"enum": ["idle", "verifying", "syncing", "cancelled"],
				"description": "Current operation status"
			},
			"SyncStatus": {
				"type": ["string", "null"],
				"enum": ["completed", "failed", null],
				"description": "Last sync result"
			},
			"DataSourceSeedResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean"
					},
					"created": {
						"type": "integer",
						"description": "Number of data sources created"
					},
					"existing": {
						"type": "integer",
						"description": "Number already existing"
					},
					"message": {
						"type": "string"
					}
				},
				"required": ["success", "created", "existing", "message"]
			},
			"DataSourceResponse": {
				"type": "object",
				"properties": {
					"data": {
						"$ref": "#/components/schemas/DataSourceConnection"
					}
				},
				"required": ["data"]
			},
			"CreateDataSourceRequest": {
				"type": "object",
				"properties": {
					"type": {
						"$ref": "#/components/schemas/DataSourceType"
					},
					"name": {
						"type": "string",
						"minLength": 1,
						"maxLength": 255,
						"example": "My ServiceNow Instance"
					},
					"description": {
						"type": "string",
						"maxLength": 1000,
						"example": "Production ServiceNow KB"
					},
					"settings": {
						"type": "object",
						"additionalProperties": {},
						"description": "Connection-specific settings"
					}
				},
				"required": ["type", "name"]
			},
			"UpdateDataSourceRequest": {
				"type": "object",
				"properties": {
					"name": {
						"type": "string",
						"minLength": 1,
						"maxLength": 255
					},
					"description": {
						"type": "string",
						"maxLength": 1000
					},
					"settings": {
						"type": "object",
						"additionalProperties": {}
					},
					"enabled": {
						"type": "boolean",
						"description": "Enable/disable the connection"
					}
				}
			},
			"DataSourceDeleteResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean"
					},
					"message": {
						"type": "string"
					}
				},
				"required": ["success", "message"]
			},
			"DataSourceVerifyResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean"
					},
					"message": {
						"type": "string",
						"example": "Verification initiated"
					},
					"connection_id": {
						"type": "string",
						"format": "uuid"
					}
				},
				"required": ["success", "message", "connection_id"]
			},
			"DataSourceSyncResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean"
					},
					"message": {
						"type": "string",
						"example": "Sync initiated"
					},
					"connection_id": {
						"type": "string",
						"format": "uuid"
					}
				},
				"required": ["success", "message", "connection_id"]
			},
			"DataSourceSyncTicketsResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean"
					},
					"message": {
						"type": "string",
						"example": "Ticket sync initiated"
					},
					"connection_id": {
						"type": "string",
						"format": "uuid"
					},
					"ingestion_run_id": {
						"type": "string",
						"format": "uuid"
					}
				},
				"required": ["success", "message", "connection_id", "ingestion_run_id"]
			},
			"FlagCheckResponse": {
				"type": "object",
				"properties": {
					"flagName": {
						"type": "string",
						"description": "Feature flag name"
					},
					"isEnabled": {
						"type": "boolean",
						"description": "Whether flag is enabled for tenant"
					}
				},
				"required": ["flagName", "isEnabled"]
			},
			"BatchFlagsResponse": {
				"type": "object",
				"properties": {
					"flags": {
						"type": "object",
						"additionalProperties": {
							"type": "boolean"
						},
						"description": "Map of flag names to enabled status"
					}
				},
				"required": ["flags"]
			},
			"BatchFlagsRequest": {
				"type": "object",
				"properties": {
					"flagNames": {
						"type": "array",
						"items": {
							"type": "string"
						},
						"minItems": 1,
						"description": "Array of flag names to check"
					}
				},
				"required": ["flagNames"]
			},
			"UpdateFlagRuleResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"flagName": {
						"type": "string",
						"description": "Feature flag name"
					},
					"isEnabled": {
						"type": "boolean",
						"description": "New enabled status"
					}
				},
				"required": ["success", "flagName", "isEnabled"]
			},
			"UpdateFlagRuleRequest": {
				"type": "object",
				"properties": {
					"isEnabled": {
						"type": "boolean",
						"description": "New enabled status for flag"
					}
				},
				"required": ["isEnabled"]
			},
			"FileUploadResponse": {
				"type": "object",
				"properties": {
					"document": {
						"$ref": "#/components/schemas/Document"
					}
				},
				"required": ["document"]
			},
			"Document": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "Document ID"
					},
					"filename": {
						"type": "string",
						"description": "File name",
						"example": "guide.pdf"
					},
					"size": {
						"type": "number",
						"description": "File size in bytes",
						"example": 102400
					},
					"type": {
						"type": "string",
						"description": "MIME type",
						"example": "application/pdf"
					},
					"status": {
						"type": "string",
						"enum": ["processing", "ready", "failed"],
						"description": "File processing status"
					},
					"source": {
						"type": "string",
						"enum": ["manual", "confluence", "jira", "sharepoint"],
						"description": "Source of the file"
					},
					"created_at": {
						"type": "string",
						"format": "date-time",
						"description": "Creation timestamp"
					}
				},
				"required": ["id", "filename", "size", "type", "status", "created_at"]
			},
			"FileConflictResponse": {
				"type": "object",
				"properties": {
					"error": {
						"type": "string",
						"enum": ["File already uploaded"]
					},
					"existing_filename": {
						"type": "string",
						"description": "Name of existing file with same content"
					}
				},
				"required": ["error", "existing_filename"]
			},
			"FileContentResponse": {
				"type": "object",
				"properties": {
					"document": {
						"type": "object",
						"properties": {
							"id": {
								"type": "string",
								"format": "uuid"
							},
							"filename": {
								"type": "string"
							},
							"size": {
								"type": "number"
							},
							"type": {
								"type": "string"
							},
							"status": {
								"type": "string",
								"enum": ["processing", "ready", "failed"],
								"description": "File processing status"
							},
							"created_at": {
								"type": "string",
								"format": "date-time"
							}
						},
						"required": [
							"id",
							"filename",
							"size",
							"type",
							"status",
							"created_at"
						]
					}
				},
				"required": ["document"]
			},
			"FileContentRequest": {
				"type": "object",
				"properties": {
					"content": {
						"type": "string",
						"description": "Text content to store"
					},
					"filename": {
						"type": "string",
						"description": "File name for the content",
						"example": "notes.txt"
					},
					"metadata": {
						"type": "object",
						"additionalProperties": {},
						"description": "Optional metadata"
					}
				},
				"required": ["content", "filename"]
			},
			"FileMetadataResponse": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "Document ID"
					},
					"organization_id": {
						"type": "string",
						"format": "uuid",
						"description": "Organization ID"
					},
					"user_id": {
						"type": "string",
						"format": "uuid",
						"description": "Uploader user ID"
					},
					"filename": {
						"type": "string",
						"description": "File name"
					},
					"file_size": {
						"type": "number",
						"description": "File size in bytes"
					},
					"mime_type": {
						"type": "string",
						"description": "MIME type"
					},
					"status": {
						"type": "string",
						"enum": ["processing", "ready", "failed"],
						"description": "File processing status"
					},
					"processed_markdown": {
						"type": ["string", "null"],
						"description": "Processed content as markdown"
					},
					"metadata": {
						"type": "object",
						"additionalProperties": {},
						"description": "File metadata including content"
					},
					"created_at": {
						"type": "string",
						"format": "date-time",
						"description": "Creation timestamp"
					},
					"updated_at": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "Last update timestamp"
					},
					"blob_id": {
						"type": "string",
						"description": "Blob storage ID"
					},
					"_lookup_strategy": {
						"type": "string",
						"description": "Debug: lookup method used"
					}
				},
				"required": [
					"id",
					"organization_id",
					"user_id",
					"filename",
					"file_size",
					"mime_type",
					"status",
					"processed_markdown",
					"metadata",
					"created_at",
					"updated_at",
					"blob_id"
				]
			},
			"FileListResponse": {
				"type": "object",
				"properties": {
					"documents": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/FileListItem"
						}
					},
					"total": {
						"type": "number",
						"description": "Total count matching filters"
					},
					"limit": {
						"type": "number"
					},
					"offset": {
						"type": "number"
					}
				},
				"required": ["documents", "total", "limit", "offset"]
			},
			"FileListItem": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid"
					},
					"file_name": {
						"type": "string"
					},
					"file_size": {
						"type": "number"
					},
					"mime_type": {
						"type": "string"
					},
					"status": {
						"type": "string",
						"enum": ["processing", "ready", "failed"],
						"description": "File processing status"
					},
					"metadata": {
						"type": ["object", "null"],
						"additionalProperties": {}
					},
					"user_id": {
						"type": "string",
						"format": "uuid"
					},
					"created_at": {
						"type": "string",
						"format": "date-time"
					},
					"updated_at": {
						"type": ["string", "null"],
						"format": "date-time"
					},
					"source": {
						"type": ["string", "null"],
						"enum": ["manual", "confluence", "jira", "sharepoint", null],
						"description": "Source of the file"
					},
					"content_type": {
						"type": "string",
						"enum": ["text", "binary"]
					}
				},
				"required": [
					"id",
					"file_name",
					"file_size",
					"mime_type",
					"status",
					"metadata",
					"user_id",
					"created_at",
					"updated_at",
					"source",
					"content_type"
				]
			},
			"FileProcessResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"example": "Document sent for processing"
					},
					"document_id": {
						"type": "string",
						"format": "uuid"
					}
				},
				"required": ["success", "message", "document_id"]
			},
			"FileProcessRequest": {
				"type": "object",
				"properties": {
					"enable_processing": {
						"type": "boolean",
						"description": "Must be true to trigger processing",
						"example": true
					}
				},
				"required": ["enable_processing"]
			},
			"FileDeleteResponse": {
				"type": "object",
				"properties": {
					"deleted": {
						"type": "boolean",
						"enum": [true]
					},
					"document_id": {
						"type": "string",
						"format": "uuid"
					},
					"blob_id": {
						"type": "string"
					}
				},
				"required": ["deleted", "document_id", "blob_id"]
			},
			"IframeValidateResponse": {
				"type": "object",
				"properties": {
					"valid": {
						"type": "boolean",
						"description": "Whether validation succeeded"
					},
					"conversationId": {
						"type": "string",
						"format": "uuid",
						"description": "Conversation ID"
					},
					"webhookConfigLoaded": {
						"type": "boolean",
						"description": "Whether webhook config loaded"
					},
					"webhookTenantId": {
						"type": "string",
						"description": "Tenant ID from webhook config"
					},
					"titleText": {
						"type": "string",
						"description": "Custom title text from Valkey"
					},
					"welcomeText": {
						"type": "string",
						"description": "Custom welcome text from Valkey"
					},
					"placeholderText": {
						"type": "string",
						"description": "Custom placeholder text from Valkey"
					},
					"valkeyPayload": {
						"type": "object",
						"additionalProperties": {},
						"description": "Full Valkey payload (dev tools)"
					},
					"error": {
						"type": "string",
						"description": "Error message if validation failed"
					}
				},
				"required": ["valid"]
			},
			"IframeValidateRequest": {
				"type": "object",
				"properties": {
					"sessionKey": {
						"type": "string",
						"description": "Valkey session key"
					},
					"intentEid": {
						"type": "string",
						"description": "Optional intent EID for tracking"
					},
					"existingConversationId": {
						"type": "string",
						"format": "uuid",
						"description": "Existing conversation ID to resume"
					}
				},
				"required": ["sessionKey"]
			},
			"IframeDebugResponse": {
				"type": "object",
				"properties": {
					"timestamp": {
						"type": "string",
						"format": "date-time",
						"description": "Current timestamp"
					},
					"valkey": {
						"type": "object",
						"properties": {
							"connected": {
								"type": "boolean",
								"description": "Valkey connection status"
							},
							"url": {
								"type": "string",
								"description": "Valkey URL (masked)"
							}
						},
						"required": ["connected"],
						"description": "Valkey status"
					},
					"environment": {
						"type": "object",
						"additionalProperties": {
							"type": "string"
						},
						"description": "Environment variable status (set/not set)"
					}
				},
				"required": ["timestamp", "valkey", "environment"]
			},
			"IframeExecuteResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"description": "Whether execution started"
					},
					"eventId": {
						"type": "string",
						"description": "Event ID for tracking"
					},
					"error": {
						"type": "string",
						"description": "Error message if failed"
					},
					"debug": {
						"type": "object",
						"properties": {
							"valkeyStatus": {},
							"totalDurationMs": {
								"type": "number"
							},
							"errorCode": {
								"type": "string"
							},
							"errorDetails": {
								"type": "string"
							}
						},
						"description": "Debug information"
					}
				},
				"required": ["success"]
			},
			"IframeExecuteRequest": {
				"type": "object",
				"properties": {
					"hashkey": {
						"type": "string",
						"description": "Valkey hashkey for workflow"
					},
					"sessionKey": {
						"type": "string",
						"description": "Alternative to hashkey (portal uses this)"
					}
				}
			},
			"IframeDeleteConversationResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"description": "Whether deletion succeeded"
					},
					"error": {
						"type": "string",
						"description": "Error message if failed"
					}
				},
				"required": ["success"]
			},
			"SendInvitationsResponse": {
				"type": "object",
				"properties": {
					"successCount": {
						"type": "number",
						"description": "Number of successful invitations"
					},
					"failureCount": {
						"type": "number",
						"description": "Number of failed invitations"
					},
					"results": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/SendInvitationsResult"
						}
					}
				},
				"required": ["successCount", "failureCount", "results"]
			},
			"SendInvitationsResult": {
				"type": "object",
				"properties": {
					"email": {
						"type": "string",
						"format": "email"
					},
					"success": {
						"type": "boolean"
					},
					"error": {
						"type": "string",
						"description": "Error message if failed"
					}
				},
				"required": ["email", "success"]
			},
			"SendInvitationsRequest": {
				"type": "object",
				"properties": {
					"emails": {
						"type": "array",
						"items": {
							"type": "string",
							"format": "email"
						},
						"minItems": 1,
						"maxItems": 50,
						"description": "Email addresses to invite (max 50)"
					}
				},
				"required": ["emails"]
			},
			"VerifyInvitationResponse": {
				"type": "object",
				"properties": {
					"valid": {
						"type": "boolean"
					},
					"email": {
						"type": "string",
						"format": "email"
					},
					"organizationName": {
						"type": "string"
					},
					"expiresAt": {
						"type": "string",
						"format": "date-time"
					},
					"error": {
						"type": "string",
						"description": "Error if invalid"
					},
					"code": {
						"type": "string",
						"description": "Error code if invalid"
					}
				},
				"required": ["valid"]
			},
			"AcceptInvitationResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"example": "Account created successfully. You can sign in shortly."
					},
					"email": {
						"type": "string",
						"format": "email"
					}
				},
				"required": ["success", "message", "email"]
			},
			"AcceptInvitationRequest": {
				"type": "object",
				"properties": {
					"token": {
						"type": "string",
						"minLength": 64,
						"maxLength": 64,
						"description": "Invitation token from email"
					},
					"firstName": {
						"type": "string",
						"minLength": 1,
						"description": "User first name"
					},
					"lastName": {
						"type": "string",
						"minLength": 1,
						"description": "User last name"
					},
					"password": {
						"type": "string",
						"minLength": 1,
						"description": "User password"
					}
				},
				"required": ["token", "firstName", "lastName", "password"]
			},
			"InvitationListResponse": {
				"type": "object",
				"properties": {
					"invitations": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/Invitation"
						}
					}
				},
				"required": ["invitations"]
			},
			"Invitation": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "Invitation ID"
					},
					"email": {
						"type": "string",
						"format": "email",
						"description": "Invited email address"
					},
					"status": {
						"type": "string",
						"enum": ["pending", "accepted", "expired", "cancelled"],
						"description": "Invitation status"
					},
					"invitedBy": {
						"type": "string",
						"format": "uuid",
						"description": "User who sent invitation"
					},
					"createdAt": {
						"type": "string",
						"format": "date-time",
						"description": "Invitation created at"
					},
					"expiresAt": {
						"type": "string",
						"format": "date-time",
						"description": "Invitation expires at"
					},
					"acceptedAt": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "When invitation was accepted"
					}
				},
				"required": [
					"id",
					"email",
					"status",
					"invitedBy",
					"createdAt",
					"expiresAt",
					"acceptedAt"
				]
			},
			"CancelInvitationResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"example": "Invitation cancelled"
					}
				},
				"required": ["success", "message"]
			},
			"MemberListResponse": {
				"type": "object",
				"properties": {
					"members": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/Member"
						}
					},
					"total": {
						"type": "number",
						"description": "Total matching members"
					},
					"limit": {
						"type": "number"
					},
					"offset": {
						"type": "number"
					}
				},
				"required": ["members", "total", "limit", "offset"]
			},
			"Member": {
				"type": "object",
				"properties": {
					"userId": {
						"type": "string",
						"format": "uuid",
						"description": "User ID"
					},
					"email": {
						"type": "string",
						"format": "email",
						"description": "User email"
					},
					"name": {
						"type": ["string", "null"],
						"description": "User full name"
					},
					"firstName": {
						"type": ["string", "null"],
						"description": "User first name"
					},
					"lastName": {
						"type": ["string", "null"],
						"description": "User last name"
					},
					"role": {
						"type": "string",
						"enum": ["owner", "admin", "user"],
						"description": "Member role in organization"
					},
					"isActive": {
						"type": "boolean",
						"description": "Whether member is active"
					},
					"joinedAt": {
						"type": "string",
						"format": "date-time",
						"description": "When user joined the org"
					},
					"conversationsCount": {
						"type": "number",
						"description": "Number of conversations"
					}
				},
				"required": [
					"userId",
					"email",
					"name",
					"firstName",
					"lastName",
					"role",
					"isActive",
					"joinedAt",
					"conversationsCount"
				]
			},
			"MemberDetailResponse": {
				"type": "object",
				"properties": {
					"member": {
						"$ref": "#/components/schemas/Member"
					}
				},
				"required": ["member"]
			},
			"UpdateRoleResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"member": {
						"$ref": "#/components/schemas/Member"
					},
					"message": {
						"type": "string",
						"example": "Member role updated successfully"
					}
				},
				"required": ["success", "member", "message"]
			},
			"UpdateRoleRequest": {
				"type": "object",
				"properties": {
					"role": {
						"type": "string",
						"enum": ["owner", "admin", "user"],
						"description": "Member role in organization"
					}
				},
				"required": ["role"]
			},
			"UpdateStatusResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"member": {
						"$ref": "#/components/schemas/Member"
					},
					"message": {
						"type": "string",
						"example": "Member activated successfully"
					}
				},
				"required": ["success", "member", "message"]
			},
			"UpdateStatusRequest": {
				"type": "object",
				"properties": {
					"isActive": {
						"type": "boolean",
						"description": "Whether to activate or deactivate"
					}
				},
				"required": ["isActive"]
			},
			"RemoveMemberResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"example": "Member removed from organization"
					},
					"removedMember": {
						"type": "object",
						"properties": {
							"userId": {
								"type": "string",
								"format": "uuid"
							},
							"email": {
								"type": "string",
								"format": "email"
							}
						},
						"required": ["userId", "email"]
					}
				},
				"required": ["success", "message", "removedMember"]
			},
			"DeletePermanentResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"message": {
						"type": "string",
						"example": "Account permanently deleted"
					},
					"removedMember": {
						"type": "object",
						"properties": {
							"userId": {
								"type": "string",
								"format": "uuid"
							},
							"email": {
								"type": "string",
								"format": "email"
							}
						},
						"required": ["userId", "email"]
					}
				},
				"required": ["success", "message", "removedMember"]
			},
			"ActiveModelResponse": {
				"type": "object",
				"properties": {
					"data": {
						"$ref": "#/components/schemas/MlModel"
					}
				},
				"required": ["data"]
			},
			"MlModel": {
				"type": ["object", "null"],
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "Model ID"
					},
					"organization_id": {
						"type": "string",
						"format": "uuid",
						"description": "Organization ID"
					},
					"model_name": {
						"type": "string",
						"description": "Model name",
						"example": "ticket-classifier-v1"
					},
					"external_model_id": {
						"type": "string",
						"description": "External model reference ID",
						"example": "model_abc123"
					},
					"active": {
						"type": "boolean",
						"description": "Whether this model is currently active",
						"example": true
					},
					"metadata": {
						"$ref": "#/components/schemas/MlModelMetadata"
					},
					"training_start_date": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "When training started",
						"example": "2024-01-15T10:30:00.000Z"
					},
					"training_end_date": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "When training completed",
						"example": "2024-01-15T12:30:00.000Z"
					},
					"created_at": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "Creation timestamp",
						"example": "2024-01-15T10:30:00.000Z"
					},
					"updated_at": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "Last update timestamp",
						"example": "2024-01-15T10:30:00.000Z"
					}
				},
				"required": [
					"id",
					"organization_id",
					"model_name",
					"external_model_id",
					"active",
					"metadata",
					"training_start_date",
					"training_end_date",
					"created_at",
					"updated_at"
				],
				"description": "Active ML model or null if none active"
			},
			"MlModelMetadata": {
				"type": ["object", "null"],
				"properties": {
					"training_state": {
						"type": "string",
						"enum": ["not_started", "in_progress", "failed", "complete"],
						"description": "Model training state"
					}
				},
				"additionalProperties": {},
				"description": "Model metadata including training state"
			},
			"OrganizationListResponse": {
				"type": "object",
				"properties": {
					"organizations": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/OrganizationListItem"
						}
					}
				},
				"required": ["organizations"]
			},
			"OrganizationListItem": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid"
					},
					"name": {
						"type": "string"
					},
					"role": {
						"type": "string",
						"enum": ["owner", "admin", "member"],
						"description": "User role in organization"
					},
					"joined_at": {
						"type": "string",
						"format": "date-time",
						"description": "When user joined this org"
					},
					"is_active": {
						"type": "boolean",
						"description": "Whether this is user's active org"
					}
				},
				"required": ["id", "name", "role", "joined_at", "is_active"]
			},
			"SwitchOrgResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"activeOrganizationId": {
						"type": "string",
						"format": "uuid"
					},
					"message": {
						"type": "string",
						"example": "Active organization switched successfully"
					}
				},
				"required": ["success", "activeOrganizationId", "message"]
			},
			"SwitchOrgRequest": {
				"type": "object",
				"properties": {
					"organizationId": {
						"type": "string",
						"format": "uuid",
						"description": "Target organization ID"
					}
				},
				"required": ["organizationId"]
			},
			"CreateOrgResponse": {
				"type": "object",
				"properties": {
					"organization": {
						"$ref": "#/components/schemas/Organization"
					},
					"message": {
						"type": "string",
						"example": "Organization created successfully"
					}
				},
				"required": ["organization", "message"]
			},
			"Organization": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "Organization ID"
					},
					"name": {
						"type": "string",
						"description": "Organization name",
						"example": "Acme Inc"
					},
					"created_at": {
						"type": "string",
						"format": "date-time",
						"description": "Creation timestamp"
					},
					"updated_at": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "Last update timestamp"
					}
				},
				"required": ["id", "name", "created_at"]
			},
			"CreateOrgRequest": {
				"type": "object",
				"properties": {
					"name": {
						"type": "string",
						"minLength": 1,
						"description": "Organization name",
						"example": "New Company"
					}
				},
				"required": ["name"]
			},
			"CurrentOrgResponse": {
				"type": "object",
				"properties": {
					"organization": {
						"type": "object",
						"properties": {
							"id": {
								"type": "string",
								"format": "uuid"
							},
							"name": {
								"type": "string"
							},
							"created_at": {
								"type": "string",
								"format": "date-time"
							},
							"user_role": {
								"type": "string",
								"enum": ["owner", "admin", "member"],
								"description": "User role in organization"
							},
							"member_count": {
								"type": ["number", "null"],
								"description": "Total members in org"
							}
						},
						"required": [
							"id",
							"name",
							"created_at",
							"user_role",
							"member_count"
						]
					}
				},
				"required": ["organization"]
			},
			"UpdateOrgResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"organization": {
						"$ref": "#/components/schemas/Organization"
					}
				},
				"required": ["success", "organization"]
			},
			"UpdateOrgRequest": {
				"type": "object",
				"properties": {
					"name": {
						"type": "string",
						"minLength": 1,
						"maxLength": 100,
						"description": "New organization name"
					}
				},
				"required": ["name"]
			},
			"SSEStatsResponse": {
				"type": "object",
				"properties": {
					"timestamp": {
						"type": "string",
						"format": "date-time",
						"description": "Current timestamp"
					},
					"totalConnections": {
						"type": "number",
						"description": "Total active SSE connections"
					},
					"connectionsByOrg": {
						"type": "object",
						"additionalProperties": {
							"type": "number"
						},
						"description": "Connections grouped by organization"
					},
					"connectionsByUser": {
						"type": "object",
						"additionalProperties": {
							"type": "number"
						},
						"description": "Connections grouped by user"
					}
				},
				"required": ["timestamp", "totalConnections"]
			},
			"TicketResponse": {
				"type": "object",
				"properties": {
					"data": {
						"$ref": "#/components/schemas/Ticket"
					}
				},
				"required": ["data"]
			},
			"WorkflowGenerateResponse": {
				"type": "object",
				"properties": {
					"success": {
						"type": "boolean",
						"enum": [true]
					},
					"conversationId": {
						"type": "string",
						"format": "uuid",
						"description": "Created conversation ID"
					},
					"messageId": {
						"type": "string",
						"format": "uuid",
						"description": "Created message ID"
					}
				},
				"required": ["success", "conversationId", "messageId"]
			},
			"WorkflowGenerateRequest": {
				"type": "object",
				"properties": {
					"query": {
						"type": "string",
						"minLength": 1,
						"description": "Workflow query/prompt"
					},
					"index_name": {
						"type": "string",
						"description": "Index name for search",
						"example": "qasa_snippets3"
					}
				},
				"required": ["query"]
			},
			"HealthResponse": {
				"type": "object",
				"properties": {
					"status": {
						"type": "string",
						"enum": ["ok", "degraded"],
						"description": "Overall health status",
						"example": "ok"
					},
					"timestamp": {
						"type": "string",
						"format": "date-time",
						"description": "Health check timestamp",
						"example": "2024-01-15T10:30:00.000Z"
					},
					"services": {
						"type": "object",
						"properties": {
							"api": {
								"type": "string",
								"enum": ["ok"],
								"description": "API service status"
							},
							"rabbitmq": {
								"$ref": "#/components/schemas/RabbitMQHealth"
							}
						},
						"required": ["api", "rabbitmq"]
					}
				},
				"required": ["status", "timestamp", "services"]
			},
			"RabbitMQHealth": {
				"type": "object",
				"properties": {
					"status": {
						"type": "string",
						"enum": ["connected", "disconnected", "connecting"],
						"description": "RabbitMQ connection status",
						"example": "connected"
					},
					"lastConnectedAt": {
						"type": ["string", "null"],
						"format": "date-time",
						"description": "Last successful connection timestamp"
					},
					"reconnectAttempts": {
						"type": "number",
						"description": "Number of reconnection attempts",
						"example": 0
					},
					"consecutiveFailures": {
						"type": "number",
						"description": "Number of consecutive failures",
						"example": 0
					},
					"message": {
						"type": "string",
						"description": "Additional status message"
					}
				},
				"required": [
					"status",
					"lastConnectedAt",
					"reconnectAttempts",
					"consecutiveFailures"
				]
			}
		},
		"parameters": {}
	},
	"paths": {
		"/auth/signup": {
			"post": {
				"tags": ["Auth"],
				"summary": "Sign up new user",
				"description": "Creates a pending user and triggers webhook for email verification. User must verify email before they can log in.",
				"security": [],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/SignupRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Signup initiated, verification email sent",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/SignupResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error or email already exists",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/auth/resend-verification": {
			"post": {
				"tags": ["Auth"],
				"summary": "Resend verification email",
				"description": "Resends the verification email for pending signups. Rate limited to 1 request per 5 minutes per email.",
				"security": [],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/ResendVerificationRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Request processed (does not reveal if email exists)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ResendVerificationResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"429": {
						"description": "Rate limited - wait 5 minutes",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/auth/login": {
			"post": {
				"tags": ["Auth"],
				"summary": "Create session from Keycloak token",
				"description": "Creates a session cookie from a Keycloak access token. Used for browser-based flows where cookies are needed (e.g., SSE).",
				"security": [],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/LoginRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Login successful, session cookie set",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/LoginResponse"
								}
							}
						}
					},
					"400": {
						"description": "Access token required",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Invalid Keycloak token",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/auth/logout": {
			"delete": {
				"tags": ["Auth"],
				"summary": "Logout current session",
				"description": "Destroys the current session and clears the session cookie.",
				"security": [],
				"responses": {
					"200": {
						"description": "Logout successful",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/LogoutResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error (session still cleared)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/auth/logout-all": {
			"delete": {
				"tags": ["Auth"],
				"summary": "Logout from all devices",
				"description": "Destroys all sessions for the current user across all devices. Requires a valid session.",
				"security": [],
				"responses": {
					"200": {
						"description": "All sessions destroyed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/LogoutAllResponse"
								}
							}
						}
					},
					"401": {
						"description": "No valid session",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error (current session still cleared)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/auth/verify-email": {
			"post": {
				"tags": ["Auth"],
				"summary": "Verify email address",
				"description": "Verifies a signup token from the email verification link. Marks user as ready for Keycloak signin.",
				"security": [],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/VerifyEmailRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Email verified successfully",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/VerifyEmailResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid/expired token or account already exists",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/auth/session": {
			"get": {
				"tags": ["Auth"],
				"summary": "Check session status",
				"description": "Returns the current session status and user info if authenticated.",
				"security": [],
				"responses": {
					"200": {
						"description": "Session is valid",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/SessionResponse"
								}
							}
						}
					},
					"401": {
						"description": "No session or invalid session",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/SessionUnauthenticatedResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/auth/profile": {
			"get": {
				"tags": ["Auth"],
				"summary": "Get user profile",
				"description": "Returns the current authenticated user's profile information.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"responses": {
					"200": {
						"description": "Profile retrieved",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ProfileResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "User not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			},
			"patch": {
				"tags": ["Auth"],
				"summary": "Update user profile",
				"description": "Updates the authenticated user's firstName and/or lastName.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/UpdateProfileRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Profile updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/UpdateProfileResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error or no fields to update",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "User not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/clusters": {
			"get": {
				"tags": ["Clusters"],
				"summary": "List clusters",
				"description": "List all ticket clusters for the organization with ticket counts",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"enum": ["volume", "automation", "recent"],
							"default": "recent",
							"description": "Sort order"
						},
						"required": false,
						"description": "Sort order",
						"name": "sort",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"enum": ["last30", "last90", "last6months", "lastyear"],
							"description": "Time period filter for ticket counts"
						},
						"required": false,
						"description": "Time period filter for ticket counts",
						"name": "period",
						"in": "query"
					},
					{
						"schema": {
							"type": ["boolean", "null"],
							"description": "Include inactive clusters"
						},
						"required": false,
						"description": "Include inactive clusters",
						"name": "include_inactive",
						"in": "query"
					},
					{
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 25,
							"description": "Results per page"
						},
						"required": false,
						"description": "Results per page",
						"name": "limit",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"description": "Pagination cursor (timestamp_id format)"
						},
						"required": false,
						"description": "Pagination cursor (timestamp_id format)",
						"name": "cursor",
						"in": "query"
					},
					{
						"schema": {
							"allOf": [
								{
									"$ref": "#/components/schemas/KBStatus"
								},
								{
									"description": "Filter by knowledge base status"
								}
							]
						},
						"required": false,
						"description": "Filter by knowledge base status",
						"name": "kb_status",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"description": "Search in cluster name and subcluster name"
						},
						"required": false,
						"description": "Search in cluster name and subcluster name",
						"name": "search",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "List of clusters",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ClusterListResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ValidationError"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/clusters/{id}/details": {
			"get": {
				"tags": ["Clusters"],
				"summary": "Get cluster details",
				"description": "Get cluster metadata including KB articles count and ticket counts",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Cluster ID"
						},
						"required": true,
						"description": "Cluster ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Cluster details",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ClusterDetailsResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Cluster not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/clusters/{id}/tickets": {
			"get": {
				"tags": ["Clusters"],
				"summary": "Get cluster tickets",
				"description": "Get paginated list of tickets in a cluster with filtering and sorting",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Cluster ID"
						},
						"required": true,
						"description": "Cluster ID",
						"name": "id",
						"in": "path"
					},
					{
						"schema": {
							"type": "string",
							"enum": ["needs_response", "completed"],
							"description": "Filter by ticket status"
						},
						"required": false,
						"description": "Filter by ticket status",
						"name": "tab",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"format": "date-time",
							"description": "Pagination cursor (ISO timestamp)"
						},
						"required": false,
						"description": "Pagination cursor (ISO timestamp)",
						"name": "cursor",
						"in": "query"
					},
					{
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 20,
							"description": "Results per page"
						},
						"required": false,
						"description": "Results per page",
						"name": "limit",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"description": "Search in subject and external_id"
						},
						"required": false,
						"description": "Search in subject and external_id",
						"name": "search",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"enum": ["created_at", "external_id", "subject"],
							"default": "created_at",
							"description": "Sort field"
						},
						"required": false,
						"description": "Sort field",
						"name": "sort",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"enum": ["asc", "desc"],
							"default": "desc",
							"description": "Sort direction"
						},
						"required": false,
						"description": "Sort direction",
						"name": "sort_dir",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"description": "Filter by data source"
						},
						"required": false,
						"description": "Filter by data source",
						"name": "source",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "Paginated list of tickets",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ClusterTicketsResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ValidationError"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Cluster not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/clusters/{id}/kb-articles": {
			"get": {
				"tags": ["Clusters"],
				"summary": "Get cluster KB articles",
				"description": "Get knowledge base articles linked to a cluster",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Cluster ID"
						},
						"required": true,
						"description": "Cluster ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "List of KB articles",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ClusterKbArticlesResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Cluster not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/conversations": {
			"post": {
				"tags": ["Conversations"],
				"summary": "Create conversation",
				"description": "Create a new chat conversation",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/CreateConversationRequest"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Conversation created",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ConversationResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ValidationError"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			},
			"get": {
				"tags": ["Conversations"],
				"summary": "List conversations",
				"description": "List user's chat conversations with pagination",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 20,
							"description": "Results per page"
						},
						"required": false,
						"description": "Results per page",
						"name": "limit",
						"in": "query"
					},
					{
						"schema": {
							"type": ["integer", "null"],
							"minimum": 0,
							"default": 0,
							"description": "Number of results to skip"
						},
						"required": false,
						"description": "Number of results to skip",
						"name": "offset",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "List of conversations",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ConversationsListResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/conversations/{conversationId}/messages": {
			"get": {
				"tags": ["Conversations"],
				"summary": "Get conversation messages",
				"description": "Get paginated messages for a conversation using cursor-based pagination",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Conversation ID"
						},
						"required": true,
						"description": "Conversation ID",
						"name": "conversationId",
						"in": "path"
					},
					{
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 100,
							"description": "Results per page"
						},
						"required": false,
						"description": "Results per page",
						"name": "limit",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"format": "date-time",
							"description": "Cursor for pagination (ISO timestamp)"
						},
						"required": false,
						"description": "Cursor for pagination (ISO timestamp)",
						"name": "before",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "List of messages",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/MessagesResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Conversation not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			},
			"post": {
				"tags": ["Conversations"],
				"summary": "Send message",
				"description": "Send a new message to a conversation. Triggers webhook for processing.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Conversation ID"
						},
						"required": true,
						"description": "Conversation ID",
						"name": "conversationId",
						"in": "path"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/CreateMessageRequest"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Message sent",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/MessageCreatedResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ValidationError"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Conversation not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/conversations/{conversationId}": {
			"patch": {
				"tags": ["Conversations"],
				"summary": "Update conversation",
				"description": "Update conversation title",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Conversation ID"
						},
						"required": true,
						"description": "Conversation ID",
						"name": "conversationId",
						"in": "path"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/UpdateConversationRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Conversation updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ConversationResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ValidationError"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Conversation not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			},
			"delete": {
				"tags": ["Conversations"],
				"summary": "Delete conversation",
				"description": "Delete a conversation and all its messages",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Conversation ID"
						},
						"required": true,
						"description": "Conversation ID",
						"name": "conversationId",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Conversation deleted",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DeleteConversationResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Conversation not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/credential-delegations/create": {
			"post": {
				"tags": ["Credential Delegations"],
				"summary": "Create credential delegation",
				"description": "Create a new credential delegation and send email to IT admin. Rate limited to 10 per org per day.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/CreateDelegationRequest"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Delegation created and email sent",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/CreateDelegationResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid input",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"409": {
						"description": "Delegation already exists for this admin",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"429": {
						"description": "Rate limit exceeded (10/day)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/credential-delegations/verify/{token}": {
			"get": {
				"tags": ["Credential Delegations"],
				"summary": "Verify delegation token",
				"description": "Verify a delegation token and return details. Public endpoint - token is the auth.",
				"security": [],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"minLength": 64,
							"maxLength": 64,
							"description": "Delegation token"
						},
						"required": true,
						"description": "Delegation token",
						"name": "token",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Token verification result",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/VerifyDelegationResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid token format",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/VerifyDelegationResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/VerifyDelegationResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/credential-delegations/submit": {
			"post": {
				"tags": ["Credential Delegations"],
				"summary": "Submit ITSM credentials",
				"description": "Submit ITSM credentials via delegation token. Public endpoint - token is the auth.",
				"security": [],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/SubmitCredentialsRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Credentials submitted",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/SubmitCredentialsResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid input or credentials",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"409": {
						"description": "Token already used",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"410": {
						"description": "Token expired",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/credential-delegations/status/{token}": {
			"get": {
				"tags": ["Credential Delegations"],
				"summary": "Get delegation status",
				"description": "Get delegation status by token. Public endpoint for polling.",
				"security": [],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"minLength": 64,
							"maxLength": 64,
							"description": "Delegation token"
						},
						"required": true,
						"description": "Delegation token",
						"name": "token",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Delegation status",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DelegationStatusResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid token",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Token not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/credential-delegations": {
			"get": {
				"tags": ["Credential Delegations"],
				"summary": "List delegations",
				"description": "List credential delegations for the organization.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"enum": ["pending", "completed", "expired", "cancelled"],
							"description": "Filter by status"
						},
						"required": false,
						"description": "Filter by status",
						"name": "status",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"enum": ["servicenow_itsm", "jira"],
							"description": "Filter by ITSM system"
						},
						"required": false,
						"description": "Filter by ITSM system",
						"name": "system_type",
						"in": "query"
					},
					{
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"description": "Max results"
						},
						"required": false,
						"description": "Max results",
						"name": "limit",
						"in": "query"
					},
					{
						"schema": {
							"type": ["integer", "null"],
							"minimum": 0,
							"description": "Pagination offset"
						},
						"required": false,
						"description": "Pagination offset",
						"name": "offset",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "Delegation list",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DelegationListResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/credential-delegations/{id}/cancel": {
			"delete": {
				"tags": ["Credential Delegations"],
				"summary": "Cancel delegation",
				"description": "Cancel a pending credential delegation.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Delegation ID"
						},
						"required": true,
						"description": "Delegation ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Delegation cancelled",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/CancelDelegationResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Delegation not found or cannot be cancelled",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/data-sources": {
			"get": {
				"tags": ["Data Sources"],
				"summary": "List data sources",
				"description": "List all data source connections for the organization",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"responses": {
					"200": {
						"description": "List of data sources",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DataSourceListResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			},
			"post": {
				"tags": ["Data Sources"],
				"summary": "Create data source",
				"description": "Create a new data source connection",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/CreateDataSourceRequest"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Data source created",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DataSourceResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ValidationError"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/data-sources/seed": {
			"post": {
				"tags": ["Data Sources"],
				"summary": "Seed default data sources",
				"description": "Create default data source configurations for the organization (idempotent)",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"responses": {
					"200": {
						"description": "Seed results",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DataSourceSeedResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/data-sources/{id}": {
			"get": {
				"tags": ["Data Sources"],
				"summary": "Get data source",
				"description": "Get a single data source connection by ID",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Data source connection ID"
						},
						"required": true,
						"description": "Data source connection ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Data source details",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DataSourceResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Data source not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			},
			"put": {
				"tags": ["Data Sources"],
				"summary": "Update data source",
				"description": "Update an existing data source connection",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Data source connection ID"
						},
						"required": true,
						"description": "Data source connection ID",
						"name": "id",
						"in": "path"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/UpdateDataSourceRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Data source updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DataSourceResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ValidationError"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Data source not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			},
			"delete": {
				"tags": ["Data Sources"],
				"summary": "Delete data source",
				"description": "Delete a data source connection",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Data source connection ID"
						},
						"required": true,
						"description": "Data source connection ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Data source deleted",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DataSourceDeleteResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Data source not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/data-sources/{id}/verify": {
			"post": {
				"tags": ["Data Sources"],
				"summary": "Verify credentials",
				"description": "Initiate credential verification for a data source. Returns immediately with status \"verifying\". Final result arrives via SSE event `data_source_update`.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Data source connection ID"
						},
						"required": true,
						"description": "Data source connection ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Verification initiated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DataSourceVerifyResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Data source not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/data-sources/{id}/sync": {
			"post": {
				"tags": ["Data Sources"],
				"summary": "Trigger sync",
				"description": "Initiate document sync from the data source. Returns immediately with status \"syncing\". Progress and completion arrive via SSE event `data_source_update`.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Data source connection ID"
						},
						"required": true,
						"description": "Data source connection ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Sync initiated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DataSourceSyncResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Data source not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/data-sources/{id}/sync-tickets": {
			"post": {
				"tags": ["Data Sources"],
				"summary": "Sync ITSM tickets",
				"description": "Initiate ITSM ticket ingestion for Autopilot clustering. Only valid for ITSM data sources (servicenow_itsm, jira_itsm). Returns HTTP 202 Accepted. Progress arrives via SSE event `ingestion_run_update`.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "ITSM data source connection ID"
						},
						"required": true,
						"description": "ITSM data source connection ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"202": {
						"description": "Ticket sync accepted",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DataSourceSyncTicketsResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid data source type (not ITSM)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Data source not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/feature-flags/{flagName}": {
			"get": {
				"tags": ["Feature Flags"],
				"summary": "Check feature flag",
				"description": "Check if a feature flag is enabled for the current tenant.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"description": "Feature flag name"
						},
						"required": true,
						"description": "Feature flag name",
						"name": "flagName",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Flag status",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/FlagCheckResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/feature-flags/batch": {
			"post": {
				"tags": ["Feature Flags"],
				"summary": "Check multiple flags",
				"description": "Check multiple feature flags in one request.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/BatchFlagsRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Batch flag status",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/BatchFlagsResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid input",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/feature-flags/{flagName}/rules": {
			"post": {
				"tags": ["Feature Flags"],
				"summary": "Update flag rule",
				"description": "Update a feature flag rule for the organization. Requires admin or owner role.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"description": "Feature flag name"
						},
						"required": true,
						"description": "Feature flag name",
						"name": "flagName",
						"in": "path"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/UpdateFlagRuleRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Flag rule updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/UpdateFlagRuleResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid input",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires admin/owner role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/files/upload": {
			"post": {
				"tags": ["Files"],
				"summary": "Upload file",
				"description": "Upload a file to the organization knowledge base. Supports images, PDFs, text, and Office documents up to 100MB. Files are deduplicated by content hash.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"multipart/form-data": {
							"schema": {
								"type": "object",
								"properties": {
									"file": {
										"description": "File to upload"
									},
									"filename": {
										"type": "string",
										"description": "Optional explicit filename (UTF-8)"
									},
									"content": {
										"type": "string",
										"description": "Optional text content override"
									}
								}
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "File uploaded successfully",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/FileUploadResponse"
								}
							}
						}
					},
					"400": {
						"description": "No file provided or file type not allowed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"409": {
						"description": "File already exists (same content hash)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/FileConflictResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/files/content": {
			"post": {
				"tags": ["Files"],
				"summary": "Create text content",
				"description": "Create text content in the organization knowledge base. Stored as a blob for consistency and deduplication.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/FileContentRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Content created successfully",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/FileContentResponse"
								}
							}
						}
					},
					"400": {
						"description": "Content and filename are required",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/files/{documentId}/metadata": {
			"get": {
				"tags": ["Files"],
				"summary": "Get file metadata",
				"description": "Get metadata for a document (used for citations). Returns metadata without raw blob content. Supports both new (blob_metadata.id) and legacy (blob_id) formats.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"description": "Document ID or blob ID"
						},
						"required": true,
						"description": "Document ID or blob ID",
						"name": "documentId",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "File metadata",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/FileMetadataResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Document not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/files/{documentId}/download": {
			"get": {
				"tags": ["Files"],
				"summary": "Download file",
				"description": "Download a file from the organization knowledge base.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Document ID"
						},
						"required": true,
						"description": "Document ID",
						"name": "documentId",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "File content (binary)",
						"content": {
							"application/octet-stream": {
								"schema": {}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Document not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/files": {
			"get": {
				"tags": ["Files"],
				"summary": "List files",
				"description": "List all files in the organization with pagination, sorting, and filtering.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 50,
							"description": "Max results",
							"example": 50
						},
						"required": false,
						"description": "Max results",
						"name": "limit",
						"in": "query"
					},
					{
						"schema": {
							"type": ["integer", "null"],
							"minimum": 0,
							"default": 0,
							"description": "Pagination offset",
							"example": 0
						},
						"required": false,
						"description": "Pagination offset",
						"name": "offset",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"enum": [
								"filename",
								"size",
								"type",
								"status",
								"source",
								"created_at"
							],
							"default": "created_at",
							"description": "Sort field"
						},
						"required": false,
						"description": "Sort field",
						"name": "sort_by",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"enum": ["ASC", "DESC", "asc", "desc"],
							"default": "DESC",
							"description": "Sort direction"
						},
						"required": false,
						"description": "Sort direction",
						"name": "sort_order",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"description": "Search filename (case-insensitive)"
						},
						"required": false,
						"description": "Search filename (case-insensitive)",
						"name": "search",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"description": "Filter by status (or 'all')"
						},
						"required": false,
						"description": "Filter by status (or 'all')",
						"name": "status",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"description": "Filter by source (or 'all')"
						},
						"required": false,
						"description": "Filter by source (or 'all')",
						"name": "source",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "Paginated file list",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/FileListResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/files/{documentId}/process": {
			"post": {
				"tags": ["Files"],
				"summary": "Trigger document processing",
				"description": "Trigger document processing via webhook to external services. Allows reprocessing for any status.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Document ID"
						},
						"required": true,
						"description": "Document ID",
						"name": "documentId",
						"in": "path"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/FileProcessRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Document sent for processing",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/FileProcessResponse"
								}
							}
						}
					},
					"400": {
						"description": "enable_processing not set to true",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Document not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error or webhook failed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/files/{documentId}": {
			"delete": {
				"tags": ["Files"],
				"summary": "Delete file",
				"description": "Delete a file from the organization. Sends webhook to external services for cleanup before database deletion. Blob is preserved if referenced by other metadata.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Document ID"
						},
						"required": true,
						"description": "Document ID",
						"name": "documentId",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "File deleted successfully",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/FileDeleteResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Document not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error or webhook failed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/iframe/validate-instantiation": {
			"post": {
				"tags": ["Iframe"],
				"summary": "Validate iframe instantiation",
				"description": "Validate Valkey session key and setup iframe session. No auth required - sessionKey is the auth.",
				"security": [],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/IframeValidateRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Validation successful",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IframeValidateResponse"
								}
							}
						}
					},
					"401": {
						"description": "Validation failed - invalid session",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IframeValidateResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/iframe/debug": {
			"get": {
				"tags": ["Iframe"],
				"summary": "Debug iframe config",
				"description": "Check Valkey status and environment configuration for debugging.",
				"security": [],
				"responses": {
					"200": {
						"description": "Debug information",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IframeDebugResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/iframe/execute": {
			"post": {
				"tags": ["Iframe"],
				"summary": "Execute workflow",
				"description": "Execute workflow from Valkey hashkey. No auth required - hashkey provides context.",
				"security": [],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/IframeExecuteRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Execution started",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IframeExecuteResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid input or execution failed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IframeExecuteResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IframeExecuteResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/iframe/conversation/{conversationId}": {
			"delete": {
				"tags": ["Iframe"],
				"summary": "Delete conversation",
				"description": "Delete iframe conversation and all messages. Used for 'Clear Chat' feature.",
				"security": [],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Conversation ID to delete"
						},
						"required": true,
						"description": "Conversation ID to delete",
						"name": "conversationId",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Conversation deleted",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IframeDeleteConversationResponse"
								}
							}
						}
					},
					"400": {
						"description": "Missing conversationId",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IframeDeleteConversationResponse"
								}
							}
						}
					},
					"500": {
						"description": "Deletion failed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/IframeDeleteConversationResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/invitations/send": {
			"post": {
				"tags": ["Invitations"],
				"summary": "Send invitations",
				"description": "Send invitations to multiple email addresses. Rate limited to 50 per org per hour.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/SendInvitationsRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Invitations sent (partial success possible)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/SendInvitationsResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid input",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"429": {
						"description": "Rate limit exceeded (50/hour)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/invitations/verify/{token}": {
			"get": {
				"tags": ["Invitations"],
				"summary": "Verify invitation token",
				"description": "Verify an invitation token and return invitation details. Public endpoint.",
				"security": [],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"minLength": 64,
							"maxLength": 64,
							"description": "Invitation token"
						},
						"required": true,
						"description": "Invitation token",
						"name": "token",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Token verification result",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/VerifyInvitationResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid token format",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/invitations/accept": {
			"post": {
				"tags": ["Invitations"],
				"summary": "Accept invitation",
				"description": "Accept invitation and create account. Public endpoint. Rate limited to 5 attempts per token per hour.",
				"security": [],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/AcceptInvitationRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Account created",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/AcceptInvitationResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid input, already accepted, expired, or account exists",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"429": {
						"description": "Too many attempts",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/invitations": {
			"get": {
				"tags": ["Invitations"],
				"summary": "List invitations",
				"description": "List invitations for the organization with optional status filter.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"enum": ["pending", "accepted", "expired", "cancelled"],
							"description": "Filter by status"
						},
						"required": false,
						"description": "Filter by status",
						"name": "status",
						"in": "query"
					},
					{
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 50,
							"description": "Max results"
						},
						"required": false,
						"description": "Max results",
						"name": "limit",
						"in": "query"
					},
					{
						"schema": {
							"type": ["integer", "null"],
							"minimum": 0,
							"default": 0,
							"description": "Pagination offset"
						},
						"required": false,
						"description": "Pagination offset",
						"name": "offset",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "Invitation list",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/InvitationListResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/invitations/{id}/cancel": {
			"delete": {
				"tags": ["Invitations"],
				"summary": "Cancel invitation",
				"description": "Cancel a pending invitation.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Invitation ID"
						},
						"required": true,
						"description": "Invitation ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Invitation cancelled",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/CancelInvitationResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Invitation not found or cannot be cancelled",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/members": {
			"get": {
				"tags": ["Members"],
				"summary": "List organization members",
				"description": "List all members in the organization with filtering, pagination, and sorting.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"enum": ["owner", "admin", "user"],
							"description": "Filter by role"
						},
						"required": false,
						"description": "Filter by role",
						"name": "role",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"enum": ["active", "inactive"],
							"description": "Filter by status"
						},
						"required": false,
						"description": "Filter by status",
						"name": "status",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"description": "Search by name/email"
						},
						"required": false,
						"description": "Search by name/email",
						"name": "search",
						"in": "query"
					},
					{
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 50,
							"description": "Max results"
						},
						"required": false,
						"description": "Max results",
						"name": "limit",
						"in": "query"
					},
					{
						"schema": {
							"type": ["integer", "null"],
							"minimum": 0,
							"default": 0,
							"description": "Pagination offset"
						},
						"required": false,
						"description": "Pagination offset",
						"name": "offset",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"enum": [
								"name",
								"role",
								"status",
								"joinedAt",
								"conversationsCount"
							],
							"default": "joinedAt",
							"description": "Sort field"
						},
						"required": false,
						"description": "Sort field",
						"name": "sortBy",
						"in": "query"
					},
					{
						"schema": {
							"type": "string",
							"enum": ["asc", "desc"],
							"default": "desc",
							"description": "Sort direction"
						},
						"required": false,
						"description": "Sort direction",
						"name": "sortOrder",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "Paginated member list",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/MemberListResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid query parameters",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/members/{userId}": {
			"get": {
				"tags": ["Members"],
				"summary": "Get member details",
				"description": "Get detailed information about a specific organization member.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Target user ID"
						},
						"required": true,
						"description": "Target user ID",
						"name": "userId",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Member details",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/MemberDetailResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Member not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			},
			"delete": {
				"tags": ["Members"],
				"summary": "Remove member (soft delete)",
				"description": "Remove a member from the organization. Preserves user account. Cannot remove self or last owner.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Target user ID"
						},
						"required": true,
						"description": "Target user ID",
						"name": "userId",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Member removed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/RemoveMemberResponse"
								}
							}
						}
					},
					"400": {
						"description": "Cannot remove self",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Member not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"409": {
						"description": "Cannot remove last active owner",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/members/{userId}/role": {
			"patch": {
				"tags": ["Members"],
				"summary": "Update member role",
				"description": "Update a member's role. Requires owner role. Cannot change own role or demote last owner.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Target user ID"
						},
						"required": true,
						"description": "Target user ID",
						"name": "userId",
						"in": "path"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/UpdateRoleRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Role updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/UpdateRoleResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid role or cannot modify self",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Member not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"409": {
						"description": "Cannot demote last active owner",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/members/{userId}/status": {
			"patch": {
				"tags": ["Members"],
				"summary": "Update member status",
				"description": "Activate or deactivate a member. Cannot change own status or deactivate last owner.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Target user ID"
						},
						"required": true,
						"description": "Target user ID",
						"name": "userId",
						"in": "path"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/UpdateStatusRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Status updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/UpdateStatusResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid status or cannot modify self",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Member not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"409": {
						"description": "Cannot deactivate last active owner",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/members/self/permanent": {
			"delete": {
				"tags": ["Members"],
				"summary": "Delete own account",
				"description": "Permanently delete your own account. Triggers Keycloak deletion webhook.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"description": "Optional deletion reason"
						},
						"required": false,
						"description": "Optional deletion reason",
						"name": "reason",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "Account deleted",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DeletePermanentResponse"
								}
							}
						}
					},
					"400": {
						"description": "Cannot delete if last active owner",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "User not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"502": {
						"description": "Keycloak webhook failed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/members/{userId}/permanent": {
			"delete": {
				"tags": ["Members"],
				"summary": "Delete member permanently",
				"description": "Permanently delete a member. Requires owner role. Triggers Keycloak deletion webhook.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Target user ID"
						},
						"required": true,
						"description": "Target user ID",
						"name": "userId",
						"in": "path"
					},
					{
						"schema": {
							"type": "string",
							"description": "Optional deletion reason"
						},
						"required": false,
						"description": "Optional deletion reason",
						"name": "reason",
						"in": "query"
					}
				],
				"responses": {
					"200": {
						"description": "Member permanently deleted",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/DeletePermanentResponse"
								}
							}
						}
					},
					"400": {
						"description": "Cannot delete self or last active owner",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner role",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Member not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"502": {
						"description": "Keycloak webhook failed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/ml-models/active": {
			"get": {
				"tags": ["ML Models"],
				"summary": "Get active ML model",
				"description": "Returns the currently active ML model for the user's organization",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"responses": {
					"200": {
						"description": "Active model or null if none active",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ActiveModelResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations": {
			"get": {
				"tags": ["Organizations"],
				"summary": "List user organizations",
				"description": "Get all organizations the authenticated user is a member of.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"responses": {
					"200": {
						"description": "List of organizations",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/OrganizationListResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/switch": {
			"post": {
				"tags": ["Organizations"],
				"summary": "Switch active organization",
				"description": "Switch the user's active organization. User must be a member of the target organization.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/SwitchOrgRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Organization switched successfully",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/SwitchOrgResponse"
								}
							}
						}
					},
					"400": {
						"description": "Organization ID is required",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Not a member of target organization",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/create": {
			"post": {
				"tags": ["Organizations"],
				"summary": "Create organization",
				"description": "Create a new organization. The creating user becomes the owner.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/CreateOrgRequest"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Organization created",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/CreateOrgResponse"
								}
							}
						}
					},
					"400": {
						"description": "Organization name is required",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/current": {
			"get": {
				"tags": ["Organizations"],
				"summary": "Get current organization",
				"description": "Get details of the user's currently active organization.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"responses": {
					"200": {
						"description": "Current organization details",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/CurrentOrgResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Organization not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/organizations/{id}": {
			"patch": {
				"tags": ["Organizations"],
				"summary": "Update organization",
				"description": "Update organization name. Requires owner or admin role. Can only update active organization.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Organization ID"
						},
						"required": true,
						"description": "Organization ID",
						"name": "id",
						"in": "path"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/UpdateOrgRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Organization updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/UpdateOrgResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden - requires owner/admin or not active org",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Organization not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/sse/events": {
			"get": {
				"tags": ["SSE"],
				"summary": "SSE events stream",
				"description": "Server-Sent Events endpoint for real-time updates. Returns a stream of events.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"responses": {
					"200": {
						"description": "SSE event stream",
						"content": {
							"text/event-stream": {
								"schema": {
									"type": "string",
									"description": "SSE event stream"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized - user context required",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/sse/stats": {
			"get": {
				"tags": ["SSE"],
				"summary": "SSE connection stats",
				"description": "Get current SSE connection statistics for monitoring.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"responses": {
					"200": {
						"description": "Connection statistics",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/SSEStatsResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/tickets/{id}": {
			"get": {
				"tags": ["Tickets"],
				"summary": "Get ticket by ID",
				"description": "Retrieve a single ticket by its ID",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"parameters": [
					{
						"schema": {
							"type": "string",
							"format": "uuid",
							"description": "Ticket ID"
						},
						"required": true,
						"description": "Ticket ID",
						"name": "id",
						"in": "path"
					}
				],
				"responses": {
					"200": {
						"description": "Ticket details",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/TicketResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"404": {
						"description": "Ticket not found",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/api/workflows/generate": {
			"post": {
				"tags": ["Workflows"],
				"summary": "Generate workflow",
				"description": "Generate a dynamic workflow from a query. Creates conversation and message, then sends webhook.",
				"security": [
					{
						"bearerAuth": []
					},
					{
						"cookieAuth": []
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/WorkflowGenerateRequest"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Workflow generation started",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/WorkflowGenerateResponse"
								}
							}
						}
					},
					"400": {
						"description": "Invalid input - query required",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					},
					"500": {
						"description": "Workflow generation failed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ErrorResponse"
								}
							}
						}
					}
				}
			}
		},
		"/health": {
			"get": {
				"tags": ["Health"],
				"summary": "Health check",
				"description": "Check API server health and service status",
				"security": [],
				"responses": {
					"200": {
						"description": "Server is healthy",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/HealthResponse"
								}
							}
						}
					},
					"503": {
						"description": "Server is degraded",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/HealthResponse"
								}
							}
						}
					}
				}
			}
		}
	},
	"webhooks": {}
}
